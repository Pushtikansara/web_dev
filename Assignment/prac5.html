<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sales Dashboard — India (Single File)</title>
  <style>
    :root{
      --bg:#f4f7fb;--card:#f0b7b7;--accent:#007ACC;--accent-2:#4CAF50;--muted:#6b7280;
      --glass: rgba(15, 31, 105, 0.06);font-family:Inter, Roboto, Arial, sans-serif;
    }
    html,body{height:100%;margin:0;background:var(--bg);padding:24px;box-sizing:border-box}
    .wrap{max-width:1100px;margin:0 auto;display:grid;grid-template-columns:1fr;gap:18px}
    header{display:flex;align-items:center;justify-content:space-between;gap:12px}
    h1{margin:0;color:var(--accent)}
    .kpis{display:flex;gap:12px;flex-wrap:wrap}
    .kpi{background:var(--card);padding:14px;border-radius:10px;box-shadow:0 6px 18px var(--glass);flex:1;min-width:160px}
    .kpi .label{font-size:13px;color:var(--muted)}
    .kpi .value{font-weight:700;font-size:20px;margin-top:6px}
    .controls{display:flex;gap:8px;align-items:center}
    .controls select{padding:8px;border-radius:8px;border:1px solid #e6eef6}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px;margin-top:8px}
    .card{background:var(--card);padding:12px;border-radius:10px;box-shadow:0 6px 18px var(--glass)}
    .meta{font-size:12px;color:var(--muted)}
    .top-list{display:flex;flex-direction:column;gap:6px}
    .chip{display:inline-block;padding:6px 8px;border-radius:999px;background:#f1f8ff;color:var(--accent);font-weight:700;font-size:12px}
    footer{font-size:13px;color:var(--muted);text-align:center;margin-top:12px}
    #24Ce052{position:fixed;top:12px;right:12px;background:var(--accent-2);color:#fff;padding:8px 12px;border-radius:6px;font-weight:700;box-shadow:0 4px 12px rgba(0,0,0,0.15);z-index:9999}
    @media (max-width:640px){.kpis{flex-direction:column}}
  </style>
</head>
<body>
  <div class="wrap" id="dashboard-root" role="application" aria-labelledby="dashboard-title">
    <header>
      <div>
        <h1 id="dashboard-title">Sales Dashboard — India</h1>
        <div class="meta" id="subtitle">Interactive cards + KPIs (client-side, INR)</div>
      </div>
      <div class="controls">
        <label for="topN" class="meta">Top N:</label>
        <select id="topN" aria-label="Top N">
          <option value="3">Top 3</option>
          <option value="5" selected>Top 5</option>
          <option value="10">Top 10</option>
        </select>
      </div>
    </header>

    <section class="kpis" aria-hidden="false">
      <div class="kpi">
        <div class="label">Total Revenue</div>
        <div class="value" id="k-total">₹0</div>
      </div>
      <div class="kpi">
        <div class="label">Average Order Value</div>
        <div class="value" id="k-avg">₹0</div>
      </div>
      <div class="kpi">
        <div class="label">Total Units</div>
        <div class="value" id="k-units">0</div>
      </div>
      <div class="kpi">
        <div class="label">Transactions</div>
        <div class="value" id="k-count">0</div>
      </div>
    </section>

    <section>
      <div style="display:flex;gap:12px;align-items:flex-start">
        <div style="flex:1">
          <h3 style="margin:0 0 8px 0">Sales Records</h3>
          <div id="cards" class="grid" role="list"></div>
        </div>

        <aside style="width:320px;min-width:240px">
          <h3 style="margin:0 0 8px 0">Top Products</h3>
          <div id="topProducts" class="top-list"></div>

          <h3 style="margin:14px 0 8px 0">Highest Transactions</h3>
          <div id="topTx" class="top-list"></div>
        </aside>
      </div>
    </section>

    <footer>Built with map / filter / reduce / sort — single file demo.</footer>
  </div>

  <div id="24Ce052" aria-hidden="true">24Ce052</div>

  <script>
    // Sample dataset (Indian names, INR amounts)
    const data = [
      { id:1, product:'Aakash Phone', region:'Delhi', revenue: 12999.00, units:1, date:'2025-09-03' },
      { id:2, product:'Rohit Tablet', region:'Mumbai', revenue: 7990.50, units:1, date:'2025-09-10' },
      { id:3, product:'Neelam Laptop', region:'Bengaluru', revenue: 74990.00, units:1, date:'2025-08-21' },
      { id:4, product:'Aakash Phone', region:'Chennai', revenue: 11995.00, units:1, date:'2025-09-12' },
      { id:5, product:'Sonal Watch', region:'Hyderabad', revenue: 1999.99, units:2, date:'2025-09-15' },
      { id:6, product:'Rohit Tablet', region:'Delhi', revenue: 8990.00, units:1, date:'2025-07-30' },
      { id:7, product:'Neelam Laptop', region:'Mumbai', revenue: 85990.00, units:1, date:'2025-09-02' },
      { id:8, product:'Priya Headset', region:'Kolkata', revenue: 1290.00, units:3, date:'2025-09-18' },
      { id:9, product:'Aakash Phone', region:'Pune', revenue: 13990.00, units:1, date:'2025-09-20' },
      { id:10, product:'Sonal Watch', region:'Ahmedabad', revenue: 2499.99, units:1, date:'2025-08-05' }
    ];

    // DOM refs
    const cardsEl = document.getElementById('cards');
    const topProductsEl = document.getElementById('topProducts');
    const topTxEl = document.getElementById('topTx');
    const kTotal = document.getElementById('k-total');
    const kAvg = document.getElementById('k-avg');
    const kUnits = document.getElementById('k-units');
    const kCount = document.getElementById('k-count');
    const topNSelect = document.getElementById('topN');

    // INR formatter
    const fmt = (v) => new Intl.NumberFormat('en-IN', { style:'currency', currency:'INR', maximumFractionDigits:2 }).format(v);
    const intFmt = (n) => n.toLocaleString('en-IN');

    // Calculations using map/filter/reduce/sort

    // total revenue
    const totalRevenue = () => data.map(r => r.revenue).reduce((acc, val) => acc + val, 0);

    // total units
    const totalUnits = () => data.map(r => r.units).reduce((a,b) => a + b, 0);

    // average order value
    const averageOrder = () => {
      const cnt = data.length;
      return cnt === 0 ? 0 : totalRevenue() / cnt;
    };

    // aggregate revenue by product
    const productAggregates = () => {
      const agg = data.reduce((acc, row) => {
        acc[row.product] = acc[row.product] || { product: row.product, revenue: 0, units: 0, count:0 };
        acc[row.product].revenue += row.revenue;
        acc[row.product].units += row.units;
        acc[row.product].count += 1;
        return acc;
      }, {});
      return Object.values(agg).sort((a,b) => b.revenue - a.revenue);
    };

    // top transactions by revenue
    const topTransactions = (n=5) => data.slice().sort((a,b) => b.revenue - a.revenue).slice(0,n);

    // recent month filter
    const recentMonth = (dateStr) => {
      const daysBack = 30;
      const d = new Date(dateStr);
      const ago = new Date();
      ago.setDate(ago.getDate() - daysBack);
      return d >= ago;
    };
    const recentSales = () => data.filter(r => recentMonth(r.date));

    // Render functions
    const renderKPIs = () => {
      kTotal.textContent = fmt(totalRevenue());
      kAvg.textContent = fmt(averageOrder());
      kUnits.textContent = intFmt(totalUnits());
      kCount.textContent = intFmt(data.length);
    };

    const renderCards = () => {
      cardsEl.innerHTML = '';
      const rows = data.slice().sort((a,b) => new Date(b.date) - new Date(a.date) || b.revenue - a.revenue);
      rows.forEach(r => {
        const el = document.createElement('div');
        el.className = 'card';
        el.innerHTML = `
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <div style="font-weight:700">${r.product}</div>
              <div class="meta">${r.region} · ${r.date}</div>
            </div>
            <div style="text-align:right">
              <div style="font-weight:700">${fmt(r.revenue)}</div>
              <div class="meta">${r.units} unit${r.units>1?'s':''}</div>
            </div>
          </div>
        `;
        cardsEl.appendChild(el);
      });
    };

    const renderTopProducts = (n) => {
      topProductsEl.innerHTML = '';
      const top = productAggregates().slice(0, n);
      top.forEach(p => {
        const d = document.createElement('div');
        d.innerHTML = `<span class="chip">${p.product}</span> <span class="meta" style="margin-left:8px">${fmt(p.revenue)} • ${p.count} tx • ${p.units} units</span>`;
        topProductsEl.appendChild(d);
      });
    };

    const renderTopTx = (n) => {
      topTxEl.innerHTML = '';
      const tx = topTransactions(n);
      tx.forEach(t => {
        const d = document.createElement('div');
        d.innerHTML = `<strong>${t.product}</strong> — ${fmt(t.revenue)} <span class="meta">(${t.date} • ${t.region})</span>`;
        topTxEl.appendChild(d);
      });
    };

    // Full render
    const render = () => {
      const n = Number(topNSelect.value) || 5;
      renderKPIs();
      renderCards();
      renderTopProducts(n);
      renderTopTx(n);
    };

    // Interactions
    topNSelect.addEventListener('change', () => render());

    // initial render
    render();
  </script>
</body>
</html>