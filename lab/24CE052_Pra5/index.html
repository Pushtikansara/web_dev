<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>JSON Data Rendering - 24CE052</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f4f4f4; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 2px solid #ccc; padding-bottom: 10px; }
        .user-info { font-size: 14px; font-weight: bold; color: #555; }
        .container { max-width: 900px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        .section-box { border: 1px solid #ddd; padding: 15px; margin-bottom: 20px; border-radius: 5px; }
        h2 { color: #333; border-bottom: 1px solid #eee; padding-bottom: 5px; }
        .event-item { background-color: #e0f7fa; padding: 8px; margin-bottom: 5px; border-radius: 3px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #00bcd4; color: white; }
        .pagination button { padding: 8px 15px; margin: 0 5px; cursor: pointer; background-color: #0097a7; color: white; border: none; border-radius: 4px; }
        .pagination button:disabled { background-color: #ccc; cursor: not-allowed; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Dynamic Data Rendering (JSON & JS)</h1>
            <div class="user-info">ID: 24CE052, Name: Pushti</div>
        </div>

        <div class="section-box">
            <h2>Upcoming Events List</h2>
            <div id="eventsList">Loading events...</div>
        </div>

        <div class="section-box">
            <h2>Student Profiles (Paginated)</h2>
            <div id="studentsTableContainer">
                <table>
                    <thead>
                        <tr><th>ID</th><th>Name</th><th>Email</th><th>Course</th><th>Year</th></tr>
                    </thead>
                    <tbody id="studentsTableBody">
                        <tr><td colspan="5">Loading students...</td></tr>
                    </tbody>
                </table>
            </div>
            <div class="pagination" id="studentPagination"></div>
        </div>
    </div>

    <script>
        // Key Question 3: Modularity is maintained by using a dedicated data handler object
        const DataHandler = {
            allStudents: [],
            pageSize: 3,
            currentPage: 1,

            // Key Question 1: JSON is parsed using the Fetch API and response.json()
            async fetchData() {
                try {
                    const response = await fetch('data.json');
                    if (!response.ok) throw new Error('Network response was not ok');
                    const data = await response.json(); // Parses JSON string into a JS object
                    
                    this.allStudents = data.students;
                    
                    this.displayEvents(data.events);
                    this.renderStudents();
                } catch (error) {
                    document.getElementById('eventsList').innerHTML = `<p style="color: red;">Error loading data: ${error.message}. Check if data.json exists.</p>`;
                    document.getElementById('studentsTableBody').innerHTML = `<tr><td colspan="5" style="color: red;">Error loading data.</td></tr>`;
                }
            },

            displayEvents(eventsArray) {
                const listContainer = document.getElementById('eventsList');
                let html = eventsArray.map(event => `
                    <div class="event-item">
                        <strong>${event.title}</strong> (${event.date})
                    </div>
                `).join('');
                listContainer.innerHTML = html;
            },

            // Supplementary Problem: Create pagination logic for JSON data
            renderStudents() {
                const tableBody = document.getElementById('studentsTableBody');
                const start = (this.currentPage - 1) * this.pageSize;
                const end = start + this.pageSize;
                
                // Key Question 2: Array manipulation method (slice) is used for pagination
                const studentsToDisplay = this.allStudents.slice(start, end);

                let html = studentsToDisplay.map(student => `
                    <tr>
                        <td>${student.id}</td>
                        <td>${student.name}</td>
                        <td>${student.email}</td>
                        <td>${student.course}</td>
                        <td>${student.year}</td>
                    </tr>
                `).join('');

                tableBody.innerHTML = html;
                this.renderPaginationControls();
            },

            renderPaginationControls() {
                const paginationContainer = document.getElementById('studentPagination');
                const totalPages = Math.ceil(this.allStudents.length / this.pageSize);
                paginationContainer.innerHTML = ''; // Clear previous controls

                // Previous button
                const prevButton = document.createElement('button');
                prevButton.textContent = 'Previous';
                prevButton.disabled = this.currentPage === 1;
                prevButton.onclick = () => { this.goToPage(this.currentPage - 1); };
                paginationContainer.appendChild(prevButton);

                // Page indicators (simplified)
                const pageInfo = document.createElement('span');
                pageInfo.textContent = ` Page ${this.currentPage} of ${totalPages} `;
                paginationContainer.appendChild(pageInfo);

                // Next button
                const nextButton = document.createElement('button');
                nextButton.textContent = 'Next';
                nextButton.disabled = this.currentPage === totalPages;
                nextButton.onclick = () => { this.goToPage(this.currentPage + 1); };
                paginationContainer.appendChild(nextButton);
            },

            goToPage(page) {
                this.currentPage = page;
                this.renderStudents();
            }
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            DataHandler.fetchData();
        });
    </script>
</body>
</html>